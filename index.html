<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>All Hand Gesture Ideas</title>

<style>
body { margin:0; overflow:hidden; background:black; }
#ui {
  position: fixed;
  top: 5px;
  left: 5px;
  z-index: 20;
}
#ui button {
  margin: 2px;
  padding: 6px 8px;
  font-size: 11px;
}
#cam {
  position: fixed;
  right: 5px;
  top: 5px;
  width: 90px;
  height: 120px;
  border: 2px solid cyan;
}
#cam video {
  width:100%;
  height:100%;
  object-fit:cover;
  transform: scaleX(-1);
}
</style>

<script src="https://cdn.jsdelivr.net/npm/three@0.158.0/build/three.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@mediapipe/hands/hands.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@mediapipe/camera_utils/camera_utils.js"></script>
</head>

<body>

<div id="ui">
<button onclick="mode=1">1 Cursor</button>
<button onclick="mode=2">2 Draw</button>
<button onclick="mode=3">3 Music</button>
<button onclick="mode=4">4 Portal</button>
<button onclick="mode=5">5 Physics</button>
<button onclick="mode=6">6 Face FX</button>
<button onclick="mode=7">7 Menu</button>
</div>

<div id="cam"><video id="video" autoplay playsinline></video></div>

<script>
/* ================= BASIC SETUP ================= */
let mode = 1;
const scene = new THREE.Scene();
const camera = new THREE.PerspectiveCamera(60, innerWidth/innerHeight, 0.1, 2000);
camera.position.z = 400;

const renderer = new THREE.WebGLRenderer({antialias:true});
renderer.setSize(innerWidth, innerHeight);
document.body.appendChild(renderer.domElement);

scene.add(new THREE.AmbientLight(0xffffff,1));

/* ================= OBJECTS ================= */
let mainObj = new THREE.Mesh(
  new THREE.SphereGeometry(30,16,16),
  new THREE.MeshStandardMaterial({color:0x00ffff})
);
scene.add(mainObj);

/* ================= HAND TRACKING ================= */
const video = document.getElementById("video");
navigator.mediaDevices.getUserMedia({video:true}).then(s=>video.srcObject=s);

const hands = new Hands({
  locateFile:f=>`https://cdn.jsdelivr.net/npm/@mediapipe/hands/${f}`
});
hands.setOptions({maxNumHands:1, modelComplexity:0});

let hx=0, hy=0, hand=false;

hands.onResults(r=>{
  if(!r.multiHandLandmarks.length){hand=false;return;}
  hand=true;
  const h=r.multiHandLandmarks[0];
  hx=h[0].x-0.5;
  hy=-(h[0].y-0.5);
});

new Camera(video,{
  onFrame: async()=>await hands.send({image:video}),
  width:320,height:240
}).start();

/* ================= ANIMATION ================= */
let t=0;
function animate(){
  requestAnimationFrame(animate);
  t+=0.05;

  if(!hand){ renderer.render(scene,camera); return; }

  if(mode===1){ // Cursor
    mainObj.position.x=hx*300;
    mainObj.position.y=hy*300;
  }

  if(mode===2){ // Drawing
    mainObj.scale.set(1+Math.abs(hx),1,1);
  }

  if(mode===3){ // Music
    mainObj.scale.y=1+Math.sin(t)*2;
  }

  if(mode===4){ // Portal
    mainObj.rotation.y+=0.03;
  }

  if(mode===5){ // Physics
    mainObj.position.y+=hy*5;
  }

  if(mode===6){ // Face FX
    mainObj.scale.set(1+Math.abs(hy)*2,1+Math.abs(hy)*2,1);
  }

  if(mode===7){ // Menu
    mainObj.rotation.x=hx*2;
  }

  renderer.render(scene,camera);
}
animate();

addEventListener("resize",()=>{
  camera.aspect=innerWidth/innerHeight;
  camera.updateProjectionMatrix();
  renderer.setSize(innerWidth,innerHeight);
});
</script>

</body>
</html>